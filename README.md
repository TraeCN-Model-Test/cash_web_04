# CashLog - è½»é‡åŒ–æœ¬åœ°è®°è´¦/å¾…åŠCLIå·¥å…·

![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

CashLog æ˜¯ä¸€æ¬¾è½»é‡åŒ–æœ¬åœ°è®°è´¦/å¾…åŠäº‹é¡¹ç®¡ç†å·¥å…·ï¼Œä¸“ä¸ºä¸ªäººè´¢åŠ¡ç®¡ç†è®¾è®¡ã€‚æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°SQLiteæ•°æ®åº“ä¸­ï¼Œç¡®ä¿æ•°æ®éšç§å’Œå®‰å…¨æ€§ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

### ğŸ“Š äº¤æ˜“ç®¡ç†
- **æ·»åŠ äº¤æ˜“è®°å½•**ï¼šæ”¯æŒæ”¶å…¥å’Œæ”¯å‡ºè®°å½•ï¼Œå¯æ·»åŠ åˆ†ç±»ã€æ ‡ç­¾å’Œå¤‡æ³¨
- **æŸ¥çœ‹äº¤æ˜“åˆ—è¡¨**ï¼šæ”¯æŒæŒ‰æœˆä»½ã€åˆ†ç±»ã€æ ‡ç­¾å’Œäº¤æ˜“ç±»å‹ç­›é€‰
- **çµæ´»çš„æŸ¥è¯¢**ï¼šç»„åˆå¤šç§æ¡ä»¶è¿›è¡Œç²¾ç¡®æŸ¥è¯¢

### ğŸ“ å¾…åŠäº‹é¡¹ç®¡ç†
- **ä»»åŠ¡ç®¡ç†**ï¼šæ·»åŠ ã€æ›´æ–°çŠ¶æ€ã€æŸ¥çœ‹å¾…åŠäº‹é¡¹
- **çŠ¶æ€è·Ÿè¸ª**ï¼šæ”¯æŒå¾…åŠã€è¿›è¡Œä¸­ã€å·²å®Œæˆã€å·²å–æ¶ˆå››ç§çŠ¶æ€
- **æ™ºèƒ½ç­›é€‰**ï¼šæŒ‰çŠ¶æ€ã€åˆ†ç±»ã€æˆªæ­¢æ—¶é—´ç­›é€‰ä»»åŠ¡

### ğŸ“ˆ å¤šç»´åº¦æŠ¥è¡¨
- **æ—¶é—´ç»´åº¦**ï¼šæ”¯æŒæ—¥ã€å‘¨ã€æœˆã€å­£åº¦åŠè‡ªå®šä¹‰æ—¶é—´æ®µæŠ¥è¡¨
- **åˆ†ç±»ç­›é€‰**ï¼šå¯æŒ‰ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†ç±»ç”ŸæˆæŠ¥è¡¨
- **è‡ªå®šä¹‰å­—æ®µ**ï¼šå¯æŒ‡å®šå±•ç¤ºçš„å­—æ®µå†…å®¹
- **ç¯æ¯”è®¡ç®—**ï¼šæ”¯æŒä¸ä¸Šä¸€å‘¨æœŸå¯¹æ¯”åˆ†æ
- **å¤šæ ¼å¼è¾“å‡º**ï¼šæ”¯æŒçº¯æ–‡æœ¬å’ŒMarkdownæ ¼å¼è¾“å‡º

### ğŸ’¾ æ•°æ®ç®¡ç†
- **æ•°æ®å¤‡ä»½**ï¼šæ”¯æŒè‡ªå®šä¹‰è·¯å¾„å’Œå¼ºåˆ¶è¦†ç›–é€‰é¡¹
- **æ•°æ®æ¢å¤**ï¼šæ”¯æŒä»å¤‡ä»½æ–‡ä»¶æ¢å¤ï¼Œæ¢å¤å‰å¯è‡ªåŠ¨å¤‡ä»½å½“å‰æ•°æ®
- **æ•°æ®å®‰å…¨**ï¼šæ‰€æœ‰æ“ä½œéƒ½æœ‰ç¡®è®¤æœºåˆ¶ï¼Œé˜²æ­¢è¯¯æ“ä½œ

### ğŸŒ REST API
- **å¾…åŠäº‹é¡¹API**ï¼šæä¾›å®Œæ•´çš„å¾…åŠäº‹é¡¹CRUDæ“ä½œ
- **äº¤æ˜“è®°å½•API**ï¼šæä¾›äº¤æ˜“è®°å½•çš„æŸ¥è¯¢å’Œç®¡ç†åŠŸèƒ½
- **ç­›é€‰å’Œåˆ†é¡µ**ï¼šæ”¯æŒå¤šæ¡ä»¶ç­›é€‰å’Œåˆ†é¡µæŸ¥è¯¢
- **APIæ–‡æ¡£**ï¼šè‡ªåŠ¨ç”Ÿæˆçš„OpenAPIæ–‡æ¡£

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.10+
- æ¨èä½¿ç”¨ uv ä½œä¸ºåŒ…ç®¡ç†å·¥å…·

### å®‰è£…æ­¥éª¤

1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd cash_web_04
```

2. å®‰è£…ä¾èµ–
```bash
uv sync
```

3. åˆå§‹åŒ–æ•°æ®åº“ï¼ˆé¦–æ¬¡è¿è¡Œè‡ªåŠ¨å®Œæˆï¼‰
```bash
uv run python main.py --help
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åŸºæœ¬å‘½ä»¤

```bash
# æŸ¥çœ‹å¸®åŠ©
uv run python main.py --help

# æŸ¥çœ‹ç‰ˆæœ¬
uv run python main.py --version
```

### äº¤æ˜“ç®¡ç†

#### æ·»åŠ äº¤æ˜“è®°å½•
```bash
# æ·»åŠ æ”¶å…¥
uv run python main.py transaction add -a 5000.00 -c å·¥èµ„ -t æ”¶å…¥,æœˆåº¦ -n "12æœˆä»½å·¥èµ„"

# æ·»åŠ æ”¯å‡º
uv run python main.py transaction add -a -150.00 -c é¤é¥® -t æ—¥å¸¸,åˆé¤ -n "å·¥ä½œæ—¥åˆé¤"

# å¸¦æ—¶é—´çš„äº¤æ˜“ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸ºå½“å‰æ—¶é—´ï¼‰
uv run python main.py transaction add -a 200.00 -c äº¤é€š -t åœ°é“ -n "ä¸Šä¸‹ç­åœ°é“è´¹" -d "2024-12-01 08:30:00"
```

#### æŸ¥çœ‹äº¤æ˜“è®°å½•
```bash
# åˆ—å‡ºæ‰€æœ‰äº¤æ˜“
uv run python main.py transaction list

# æŒ‰æœˆä»½ç­›é€‰
uv run python main.py transaction list -m 2024-12

# æŒ‰åˆ†ç±»ç­›é€‰
uv run python main.py transaction list -c é¤é¥®

# æŒ‰äº¤æ˜“ç±»å‹ç­›é€‰
uv run python main.py transaction list --type income
uv run python main.py transaction list --type expense

# ç»„åˆç­›é€‰
uv run python main.py transaction list -m 2024-12 -c é¤é¥® -t åˆé¤
```

### å¾…åŠäº‹é¡¹ç®¡ç†

#### æ·»åŠ å¾…åŠäº‹é¡¹
```bash
# æ·»åŠ å¸¦æˆªæ­¢æ—¶é—´çš„å¾…åŠäº‹é¡¹
uv run python main.py todo add -c "å®Œæˆé¡¹ç›®æŠ¥å‘Š" -C å·¥ä½œ -t é‡è¦,ç´§æ€¥ -d "2024-12-10 18:00:00"

# æ·»åŠ æ— æˆªæ­¢æ—¶é—´çš„å¾…åŠäº‹é¡¹
uv run python main.py todo add -c "å­¦ä¹ Pythonæ–°ç‰¹æ€§" -C å­¦ä¹  -t è‡ªæˆ‘æå‡
```

#### æ›´æ–°å¾…åŠçŠ¶æ€
```bash
# æ›´æ–°ä¸ºè¿›è¡Œä¸­
uv run python main.py todo update-status 1 doing

# æ›´æ–°ä¸ºå·²å®Œæˆ
uv run python main.py todo update-status 1 done
```

#### æŸ¥çœ‹å¾…åŠäº‹é¡¹
```bash
# åˆ—å‡ºæ‰€æœ‰å¾…åŠäº‹é¡¹
uv run python main.py todo list

# æŒ‰çŠ¶æ€ç­›é€‰
uv run python main.py todo list -s todo      # åªæ˜¾ç¤ºå¾…åŠ
uv run python main.py todo list -s doing    # åªæ˜¾ç¤ºè¿›è¡Œä¸­
uv run python main.py todo list -s done     # åªæ˜¾ç¤ºå·²å®Œæˆ

# æŒ‰åˆ†ç±»ç­›é€‰
uv run python main.py todo list -c å·¥ä½œ

# æŒ‰æˆªæ­¢æ—¶é—´ç­›é€‰
uv run python main.py todo list --before 2024-12-31
uv run python main.py todo list --after 2024-12-01
```

### æŠ¥è¡¨åŠŸèƒ½

#### ç”Ÿæˆå¤šç»´åº¦æŠ¥è¡¨
```bash
# ç”Ÿæˆæ—¥æŠ¥è¡¨
uv run python main.py report generate --daily

# ç”Ÿæˆå‘¨æŠ¥è¡¨
uv run python main.py report generate --weekly

# ç”Ÿæˆæœˆåº¦æŠ¥è¡¨ï¼ˆé»˜è®¤ï¼‰
uv run python main.py report generate --monthly

# ç”Ÿæˆå­£åº¦æŠ¥è¡¨
uv run python main.py report generate --quarterly

# ç”Ÿæˆè‡ªå®šä¹‰æ—¶é—´æ®µæŠ¥è¡¨
uv run python main.py report generate --start 2024-12-01 --end 2024-12-31

# æŒ‰åˆ†ç±»ç­›é€‰ç”ŸæˆæŠ¥è¡¨
uv run python main.py report generate --category é¤é¥®,äº¤é€š

# æŒ‡å®šå±•ç¤ºå­—æ®µ
uv run python main.py report generate --fields é‡‘é¢,åˆ†ç±»,ç¬”æ•°

# è¾“å‡ºä¸ºMarkdownæ ¼å¼
uv run python main.py report generate --monthly --format markdown
```

#### å…¼å®¹æ—§æ¥å£
```bash
# ç”Ÿæˆå½“å‰æœˆæŠ¥è¡¨
uv run python main.py report monthly

# ç”ŸæˆæŒ‡å®šæœˆä»½æŠ¥è¡¨
uv run python main.py report monthly -m 2024-12
```

### æ•°æ®ç®¡ç†

#### æ•°æ®å¤‡ä»½
```bash
# ä½¿ç”¨é»˜è®¤è·¯å¾„å¤‡ä»½
uv run python main.py data backup

# æŒ‡å®šå¤‡ä»½è·¯å¾„
uv run python main.py data backup -o ~/cashlog_backup.db

# å¼ºåˆ¶è¦†ç›–å·²å­˜åœ¨çš„å¤‡ä»½æ–‡ä»¶
uv run python main.py data backup -o ~/cashlog_backup.db -f
```

#### æ•°æ®æ¢å¤
```bash
# ä»å¤‡ä»½æ–‡ä»¶æ¢å¤ï¼ˆæ¢å¤å‰è‡ªåŠ¨å¤‡ä»½å½“å‰æ•°æ®ï¼‰
uv run python main.py data restore -i ~/cashlog_backup.db

# è·³è¿‡ç¡®è®¤ç›´æ¥æ¢å¤
uv run python main.py data restore -i ~/cashlog_backup.db -y

# è·³è¿‡ç¡®è®¤ä¸”ä¸å¤‡ä»½å½“å‰æ•°æ®ç›´æ¥æ¢å¤
uv run python main.py data restore -i ~/cashlog_backup.db -y -b False
```

### REST API

#### å¯åŠ¨APIæœåŠ¡å™¨
```bash
# å¯åŠ¨APIæœåŠ¡å™¨ï¼ˆé»˜è®¤ç«¯å£8000ï¼‰
uv run python src/cashlog/rest/api.py

# è‡ªå®šä¹‰ç«¯å£
uv run python src/cashlog/rest/api.py --port 8080
```

#### APIç«¯ç‚¹
```bash
# å¾…åŠäº‹é¡¹API
GET    /todos              # è·å–å¾…åŠäº‹é¡¹åˆ—è¡¨
GET    /todos/{todo_id}    # è·å–ç‰¹å®šå¾…åŠäº‹é¡¹
POST   /todos              # åˆ›å»ºå¾…åŠäº‹é¡¹
PUT    /todos/{todo_id}    # æ›´æ–°å¾…åŠäº‹é¡¹
DELETE /todos/{todo_id}    # åˆ é™¤å¾…åŠäº‹é¡¹

# äº¤æ˜“è®°å½•API
GET    /transactions              # è·å–äº¤æ˜“è®°å½•åˆ—è¡¨
GET    /transactions/{trans_id}   # è·å–ç‰¹å®šäº¤æ˜“è®°å½•
POST   /transactions              # åˆ›å»ºäº¤æ˜“è®°å½•
PUT    /transactions/{trans_id}   # æ›´æ–°äº¤æ˜“è®°å½•
DELETE /transactions/{trans_id}   # åˆ é™¤äº¤æ˜“è®°å½•
```

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼Œå¯è¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œæµ‹è¯•ï¼š

```bash
# è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•
uv run pytest

# è¿è¡Œå®Œæ•´åŠŸèƒ½æµ‹è¯•ï¼ˆåŒ…å«æµ‹è¯•æ•°æ®ï¼‰
./scripts/run_integration_tests.sh

# æ·»åŠ äº¤æ˜“æµ‹è¯•æ•°æ®
./scripts/setup_transaction_test_data.sh

# æ·»åŠ å¾…åŠäº‹é¡¹æµ‹è¯•æ•°æ®
./scripts/setup_todo_test_data.sh
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
cash_web_04/
â”œâ”€â”€ src/cashlog/           # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ cli/              # å‘½ä»¤è¡Œæ¥å£
â”‚   â”‚   â”œâ”€â”€ data_cli.py   # æ•°æ®ç®¡ç†å‘½ä»¤
â”‚   â”‚   â”œâ”€â”€ main_cli.py   # ä¸»å‘½ä»¤æ¥å£
â”‚   â”‚   â”œâ”€â”€ report_cli.py  # æŠ¥è¡¨å‘½ä»¤
â”‚   â”‚   â”œâ”€â”€ todo_cli.py    # å¾…åŠäº‹é¡¹å‘½ä»¤
â”‚   â”‚   â””â”€â”€ transaction_cli.py # äº¤æ˜“å‘½ä»¤
â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ db.py         # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”œâ”€â”€ todo.py       # å¾…åŠäº‹é¡¹æ¨¡å‹
â”‚   â”‚   â””â”€â”€ transaction.py # äº¤æ˜“æ¨¡å‹
â”‚   â”œâ”€â”€ rest/             # REST API
â”‚   â”‚   â”œâ”€â”€ api.py        # APIä¸»å…¥å£
â”‚   â”‚   â”œâ”€â”€ models.py     # APIæ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ routers/      # APIè·¯ç”±
â”‚   â”‚       â”œâ”€â”€ todos.py  # å¾…åŠäº‹é¡¹è·¯ç”±
â”‚   â”‚       â””â”€â”€ transactions.py # äº¤æ˜“è®°å½•è·¯ç”±
â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ data_service.py # æ•°æ®ç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ report_service.py # æŠ¥è¡¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ todo_service.py # å¾…åŠäº‹é¡¹æœåŠ¡
â”‚   â”‚   â””â”€â”€ transaction_service.py # äº¤æ˜“æœåŠ¡
â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ formatter.py  # æ ¼å¼åŒ–å·¥å…·
â”œâ”€â”€ tests/                # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ test_backup_restore_cli.py            # å¤‡ä»½æ¢å¤CLIå‘½ä»¤æµ‹è¯•
â”‚   â”œâ”€â”€ test_backup_restore_service.py        # å¤‡ä»½æ¢å¤æœåŠ¡åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_cli_utilities.py                 # CLIå·¥å…·ç±»æµ‹è¯•åŸºç±»
â”‚   â”œâ”€â”€ test_report_generation_cli.py         # æŠ¥è¡¨ç”ŸæˆCLIå‘½ä»¤æµ‹è¯•
â”‚   â”œâ”€â”€ test_report_generation_service.py     # æŠ¥è¡¨ç”ŸæˆæœåŠ¡åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_rest_api.py                      # REST APIæ¥å£æµ‹è¯•
â”‚   â”œâ”€â”€ test_todo_cli.py                      # å¾…åŠäº‹é¡¹CLIå‘½ä»¤æµ‹è¯•
â”‚   â”œâ”€â”€ test_todo_service.py                  # å¾…åŠäº‹é¡¹æœåŠ¡åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_transaction_cli.py               # äº¤æ˜“è®°å½•CLIå‘½ä»¤æµ‹è¯•
â”‚   â””â”€â”€ test_transaction_service.py           # äº¤æ˜“è®°å½•æœåŠ¡åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ scripts/              # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ setup_transaction_test_data.sh  # æ·»åŠ äº¤æ˜“æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ setup_todo_test_data.sh # æ·»åŠ å¾…åŠäº‹é¡¹æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ test_backup_restore_error_cases.sh # å¤‡ä»½æ¢å¤é”™è¯¯æµ‹è¯•
â”‚   â”œâ”€â”€ test_backup_restore_workflow.sh # å¤‡ä»½æ¢å¤æ­£å¸¸æµ‹è¯•
â”‚   â”œâ”€â”€ run_integration_tests.sh  # è¿è¡Œå®Œæ•´æµ‹è¯•
â”‚   â””â”€â”€ test_transaction_todo_association.sh # äº¤æ˜“ä¸å¾…åŠå…³è”æµ‹è¯•
â”œâ”€â”€ data/                 # æ•°æ®å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ backups/          # å¤‡ä»½æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ cashlog.db        # ä¸»æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ main.py               # ç¨‹åºå…¥å£
â”œâ”€â”€ pyproject.toml        # é¡¹ç›®é…ç½®
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜
```

## ğŸ› ï¸ å¼€å‘

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Python 3.10+
- **CLIæ¡†æ¶**: Click
- **æ•°æ®åº“**: SQLAlchemy + SQLite
- **ç»ˆç«¯è¾“å‡º**: Rich
- **æµ‹è¯•æ¡†æ¶**: Pytest
- **APIæ¡†æ¶**: FastAPI
- **APIæ–‡æ¡£**: OpenAPI/Swagger

### æœ¬åœ°å¼€å‘

1. å®‰è£…å¼€å‘ä¾èµ–
```bash
uv sync --dev
```

2. è¿è¡Œæµ‹è¯•
```bash
uv run pytest
```

3. ä»£ç æ ¼å¼åŒ–
```bash
uv run black src/ tests/
```

4. å¯åŠ¨APIæœåŠ¡å™¨ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
```bash
uv run uvicorn src.cashlog.rest.api:app --reload
```

### é¡¹ç›®æ–‡æ¡£

é¡¹ç›®åŒ…å«æ ¸å¿ƒæ–‡æ¡£ï¼Œä½äºä»¥ä¸‹ä½ç½®ï¼š

- [src/cashlog/README.md](src/cashlog/README.md) - æ ¸å¿ƒæ¨¡å—æ¦‚è¿°
- [src/cashlog/api/README.md](src/cashlog/api/README.md) - REST APIæ–‡æ¡£
- [scripts/README.md](scripts/README.md) - è„šæœ¬å·¥å…·æ–‡æ¡£
- [tests/README.md](tests/README.md) - æµ‹è¯•æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ Issue è”ç³»æˆ‘ä»¬ã€‚